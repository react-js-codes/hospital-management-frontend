{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Suresh\\\\hospital-management\\\\frontend\\\\src\\\\context\\\\AuthContext.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [state, setState] = useState({\n    user: null,\n    token: localStorage.getItem('token') || null,\n    loading: true,\n    error: null\n  });\n  const navigate = useNavigate();\n\n  // Memoized function to set auth token\n  const setAuthToken = useCallback(token => {\n    if (token) {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n    } else {\n      delete axios.defaults.headers.common['Authorization'];\n    }\n  }, []);\n\n  // Load user with error handling\n  const loadUser = useCallback(async () => {\n    try {\n      setAuthToken(state.token);\n      const res = await axios.get('/api/auth/profile');\n      setState(prev => ({\n        ...prev,\n        user: res.data,\n        error: null\n      }));\n    } catch (err) {\n      setState(prev => {\n        var _err$response, _err$response$data;\n        return {\n          ...prev,\n          error: ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || err.message\n        };\n      });\n      logout();\n    } finally {\n      setState(prev => ({\n        ...prev,\n        loading: false\n      }));\n    }\n  }, [state.token, setAuthToken]);\n\n  // Auth actions\n  const register = async formData => {\n    try {\n      const res = await axios.post('/api/auth/register', formData);\n      localStorage.setItem('token', res.data.token);\n      setState(prev => ({\n        ...prev,\n        token: res.data.token\n      }));\n      await loadUser();\n      navigate('/');\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      throw ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || err.message;\n    }\n  };\n  const login = async formData => {\n    try {\n      const res = await axios.post('/api/auth/login', formData);\n      localStorage.setItem('token', res.data.token);\n      setState(prev => ({\n        ...prev,\n        token: res.data.token\n      }));\n      await loadUser();\n      navigate('/');\n    } catch (err) {\n      var _err$response3, _err$response3$data;\n      throw ((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || err.message;\n    }\n  };\n  const logout = useCallback(() => {\n    localStorage.removeItem('token');\n    setState({\n      user: null,\n      token: null,\n      loading: false,\n      error: null\n    });\n    navigate('/login');\n  }, [navigate]);\n  const setError = error => {\n    setState(prev => ({\n      ...prev,\n      error\n    }));\n  };\n\n  // Initialize auth state\n  useEffect(() => {\n    if (state.token) {\n      loadUser();\n    } else {\n      setState(prev => ({\n        ...prev,\n        loading: false\n      }));\n    }\n  }, [state.token, loadUser]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      ...state,\n      register,\n      login,\n      logout,\n      loadUser,\n      setError\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"sXpOxAuZiVO56zAj2pl1q5kbS14=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nexport function useAuth() {\n  _s2();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n_s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useContext","useState","useEffect","useCallback","axios","useNavigate","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","state","setState","user","token","localStorage","getItem","loading","error","navigate","setAuthToken","defaults","headers","common","loadUser","res","get","prev","data","err","_err$response","_err$response$data","response","message","logout","register","formData","post","setItem","_err$response2","_err$response2$data","login","_err$response3","_err$response3$data","removeItem","setError","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","context","Error","$RefreshReg$"],"sources":["C:/Users/Suresh/hospital-management/frontend/src/context/AuthContext.jsx"],"sourcesContent":["import { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [state, setState] = useState({\r\n    user: null,\r\n    token: localStorage.getItem('token') || null,\r\n    loading: true,\r\n    error: null\r\n  });\r\n\r\n  const navigate = useNavigate();\r\n\r\n  // Memoized function to set auth token\r\n  const setAuthToken = useCallback((token) => {\r\n    if (token) {\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n    } else {\r\n      delete axios.defaults.headers.common['Authorization'];\r\n    }\r\n  }, []);\r\n\r\n  // Load user with error handling\r\n  const loadUser = useCallback(async () => {\r\n    try {\r\n      setAuthToken(state.token);\r\n      const res = await axios.get('/api/auth/profile');\r\n      setState(prev => ({ ...prev, user: res.data, error: null }));\r\n    } catch (err) {\r\n      setState(prev => ({\r\n        ...prev,\r\n        error: err.response?.data?.message || err.message\r\n      }));\r\n      logout();\r\n    } finally {\r\n      setState(prev => ({ ...prev, loading: false }));\r\n    }\r\n  }, [state.token, setAuthToken]);\r\n\r\n  // Auth actions\r\n  const register = async (formData) => {\r\n    try {\r\n      const res = await axios.post('/api/auth/register', formData);\r\n      localStorage.setItem('token', res.data.token);\r\n      setState(prev => ({ ...prev, token: res.data.token }));\r\n      await loadUser();\r\n      navigate('/');\r\n    } catch (err) {\r\n      throw err.response?.data?.message || err.message;\r\n    }\r\n  };\r\n\r\n  const login = async (formData) => {\r\n    try {\r\n      const res = await axios.post('/api/auth/login', formData);\r\n      localStorage.setItem('token', res.data.token);\r\n      setState(prev => ({ ...prev, token: res.data.token }));\r\n      await loadUser();\r\n      navigate('/');\r\n    } catch (err) {\r\n      throw err.response?.data?.message || err.message;\r\n    }\r\n  };\r\n\r\n  const logout = useCallback(() => {\r\n    localStorage.removeItem('token');\r\n    setState({ user: null, token: null, loading: false, error: null });\r\n    navigate('/login');\r\n  }, [navigate]);\r\n\r\n  const setError = (error) => {\r\n    setState(prev => ({ ...prev, error }));\r\n  };\r\n\r\n  // Initialize auth state\r\n  useEffect(() => {\r\n    if (state.token) {\r\n      loadUser();\r\n    } else {\r\n      setState(prev => ({ ...prev, loading: false }));\r\n    }\r\n  }, [state.token, loadUser]);\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        ...state,\r\n        register,\r\n        login,\r\n        logout,\r\n        loadUser,\r\n        setError\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}